T.cache("X.DataCache","K",function(i){var f=K.entity(i.pkg);f.DataCache=K.clazz(K.ME,{ctor:function(c){var a=this;a.$cache={};a.$size=window.isFinite(c)?c:f.DataCache.SIZE;a.$count=0},get:function(c){var a=this,b=T.has(a.$cache,c),d=null;if(b){d=a.$cache[c];d.f++;d.t=K.now();d=d.d}return d},_delByFT:function(){var c=this,a,b=-1,d=0,e,h=c.$cache,g;for(a in h)if(T.has(h,a)){e=h[a];if(b==-1){b=e.f;d=K.now()-e.t;g=a}else if(e.f<b){g=a;b=e.f}else if(e.f==b)if(K.now()-e.t>d){g=a;d=K.now()-e.t}}g&&c.del(g)},
set:function(c,a){var b=this,d,e=T.has(b.$cache,c);if(e){d=b.$cache[c];d.d=a;d.f++;d.t=K.now();b.fire(f.DataCache.UPDATE,{key:c,value:a})}else{d={d:a,f:0,t:K.now()};b.$cache[c]=d;b.fire(f.DataCache.ADD,{key:c,value:a});if(!e){b.$count++;b.$size>-1&&b.$count>b.$size&&b._delByFT()}}},del:function(c){var a=this,b=a.$cache,d=T.has(b,c),e=b[c];if(d){delete b[c];a.fire(f.DataCache.DELETE,{key:c,value:e})}},has:function(c){var a=this;if((a=a.$cache)&&T.has(a,c))return true;return false}},{SIZE:20,DELETE:"_delte",
ADD:"_add",UPDATE:"_update"})});
