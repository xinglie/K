T.cache("X.HTA.IO","K",function(h){h=K.entity(h.pkg);var e=new ActiveXObject("Scripting.FileSystemObject"),k=/^[\s\S]*\//,l=/^[\s\S]*\\/,m=/\.[\s\S]*$/,n=/^[\s\S]*\./,o=/[A-Z]/;function p(a){return a.toLowerCase()}var q={Name:String,Path:String,DateCreated:Date,DateLastAccessed:Date,DateLastModified:Date,Size:Number,Type:String,ShortPath:String,Attributes:Number},r={Drive:String,IsRootFolder:Boolean,SubFolders:Array,Files:Array,ParentFolder:String,ShortName:String,ShortPath:String,Attributes:Number,
Type:String};function j(a,c){var b={},d;for(var f in a)if(T.has(a,f)){d=a[f];if(d===Array){d=[];for(var i=new Enumerator(c[f]);!i.atEnd();i.moveNext())d.push(i.item());d=d}else d=new d(c[f]);b[f.replace(o,p)]=d}return b}var g="";h.IO={folderExists:function(a){return e.FolderExists(a)},fileExists:function(a){return e.FileExists(a)},createFolderByPath:function(a){a=a.split("\\");for(var c="",b=0;b<a.length;b++)if(a[b]){c=c+a[b]+"\\";e.FolderExists(c)||e.CreateFolder(c)}},getFileObject:function(a){var c=
this;if(c.fileExists(a)){a=e.GetFile(a);return a=j(q,a)}return null},getFolderObject:function(a){var c=this;if(c.folderExists(a)){a=e.GetFolder(a);return a=j(r,a)}return null},getFileFullName:function(a){return String(a).replace(k,g).replace(l,g)},getFileExtensionName:function(a){if(a=this.getFileFullName(a))a=a.replace(n,g);return a},getFileBaseName:function(a){if(a=this.getFileFullName(a))a=a.replace(m,g);return a},folderDialog:function(a){a=K.mix({Hwnd:0,title:"select",options:0,rootFolder:null},
a);var c=new ActiveXObject("Shell.application");if((a=c.BrowseForFolder(a.Hwnd,a.title,a.options,a.rootFolder))&&a.Self)return a.Self.Path;return""},fileDialog:function(){var a=new ActiveXObject("InternetExplorer.Application");a.Visible=false;a.Navigate("about:blank");a.Document.write('<input type="file" id="_" />');a.Document.getElementById("_").click();var c=a.Document.getElementById("_").value;a.Quit();return c},readAsString:function(a){var c=new ActiveXObject("adodb.stream");c.Type=2;c.Mode=3;
c.Open();c.LoadFromFile(a);a=c.ReadText();c.Close();return a},readAsStream:function(a){var c=new ActiveXObject("adodb.stream");c.Type=1;c.Open();c.LoadFromFile(a);a=c.Read();c.Close();return a},writeByStream:function(a,c){var b=new ActiveXObject("adodb.stream");b.Type=1;b.Open();b.Write(c);b.SaveToFile(a,2);b.Close()},writeByString:function(a,c){var b=new ActiveXObject("adodb.stream");b.Type=2;b.Open();b.WriteText(c);b.SaveToFile(a,2);b.Close()},writeUTF8ByString:function(a,c){var b=new ActiveXObject("adodb.stream");
b.Type=2;b.Charset="utf-8";b.Open();b.WriteText(c);b.SaveToFile(a,2);b.Close()},writeUTF8NoBOMByString:function(a,c){var b=new ActiveXObject("adodb.stream");b.Type=2;b.Charset="utf-8";b.Mode=3;b.Open();b.Position=0;b.WriteText(c.substr(0,1));b.SetEOS();b.Position=0;b.Type=1;b.Position=3;var d=b.Read();b.Position=0;b.Write(d);b.SetEOS();b.Position=0;b.Type=2;b.Position=b.Size;b.WriteText(c.substr(1));b.Position=0;b.Type=1;b.SaveToFile(a,2);b.Close()},deleteFile:function(a){this.fileExists(a)&&e.DeleteFile(a)},
deleteFolder:function(a){this.folderExists(a)&&e.DeleteFolder(a)}}});
