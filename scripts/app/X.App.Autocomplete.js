T.cache("X.App.Autocomplete","X.Widget.Autocomplete,X.KeyListener,X.KeyCode",function(e){var j=K.entity(e.pkg),k=K.access(e.dps[0]),i=K.access(e.dps[1]),g=K.access(e.dps[2]),l='<ul><#for(var i=0;i<@list.length;i++){#><li id="<#=@id#>_item_<#=i#>" data-idx="<#=i#>"><#=@list[i].text#></li><#}#></ul>';j.Autocomplete=K.clazz(k,function(h,m,c){return{ctor:function(){var a=this;a.on(c.LIST_CHANGE,a.$listChange=K.bind(a._listChange,a));a.on(c.DATA_SEARCH,a.$dataSearch=K.bind(a._dataSearch,a));h.ctor.apply(a,
arguments);a.$kl=new i({zone:a.input});a.$kl.on(i.KEY_DOWN,a.$keydown=function(b){if(b.code==g.DOWN){if(b=K(a.id+"_item_"+(a.$currentIndex+1))){K.nodeStyle(a.$lastHover,{backgroundColor:"#fff"});a.$currentIndex++;K.nodeStyle(a.$lastHover=b,{backgroundColor:"#ccc"})}}else if(b.code==g.UP){if(b=K(a.id+"_item_"+(a.$currentIndex-1))){K.nodeStyle(a.$lastHover,{backgroundColor:"#fff"});a.$currentIndex--;K.nodeStyle(a.$lastHover=b,{backgroundColor:"#ccc"})}}else if(b.code==g.ENTER)if(a.$lastHover){a.$currentIndex=
-1;a._fillInput(a.$lastHover)}});a.$currentIndex=-1;a.on(c.CREATED,a.$created=function(){a.off(c.CREATED);K.on(a.id,"mouseover",a.$mouseover=function(b){b=K.evtTarget(b);if((b=a._findItemNode(b))&&K.pointerInout(b)){K.nodeStyle(a.$lastHover,{backgroundColor:"#fff"});a.$currentIndex=parseInt(K.nodeAttr(b,"data-idx"),10);K.nodeStyle(a.$lastHover=b,{backgroundColor:"#ccc"})}});K.on(a.id,"click",a.$click=function(b){b=K.evtTarget(b);(b=a._findItemNode(b))&&a._fillInput(b)})})},_fillInput:function(a){var b=
this;K.nodeVal(b.input,K.nodeVal(a));b.hide()},_findItemNode:function(a){for(var b=this,d=K.nodeIn(a.parentNode.parentNode,b.id);K.nodeIn(a.parentNode.parentNode,b.id)&&a.parentNode.parentNode.id!=b.id&&a.id!=b.id;)a=a.parentNode;return d?a:null},_dataSearch:function(a){var b=a.data,d=[];if(!a.prevent){if(a.text)for(var f=0;f<b.length;f++)~b[f].text.indexOf(text)&&d.push(b[f]);a.data=d}},_listChange:function(a){var b=this,d=a.list;b.$currentIndex=-1;a.html=K.tpFilled(l,{list:d,id:b.id})},hide:function(){var a=
this;a.$currentIndex=-1;K.nodeStyle(a.$lastHover,{backgroundColor:"#fff"});h.hide.apply(a,arguments)},dispose:function(){var a=this;a.un(c.LIST_CHANGE,a.$listChange);a.un(c.CREATED,a.$created);a.$kl&&a.$kl.dispose();K.un(a.id,"mouseover",a.$mouseover);K.un(a.id,"click",a.$click);h.dispose.apply(a,arguments)}}},{ITEM_HOVER:"_item_hover",ITEM_SELECTED:"_item_selected"})});
